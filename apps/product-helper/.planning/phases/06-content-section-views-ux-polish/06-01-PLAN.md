---
phase: 06-content-section-views-ux-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/(login)/actions.ts
  - app/(dashboard)/projects/[id]/page.tsx
  - components/projects/sections/system-overview-section.tsx
  - lib/utils/vision.ts
  - components/onboarding/welcome-onboarding.tsx
autonomous: true
subsystem: ui

must_haves:
  truths:
    - "After sign-in, returning users land on /welcome-test (not /projects)"
    - "Vision statement on overview page shows user's description without [Mode: ...] prefix or system context"
    - "PRD-SPEC Validation section is NOT visible to users on the overview page (dev-only)"
    - "System overview actor table rows do NOT highlight green on hover"
  artifacts:
    - path: "lib/utils/vision.ts"
      provides: "stripVisionMetadata() helper function"
      exports: ["stripVisionMetadata"]
    - path: "app/(login)/actions.ts"
      provides: "Post-login redirect to /welcome-test"
      contains: "redirect('/welcome-test')"
    - path: "app/(dashboard)/projects/[id]/page.tsx"
      provides: "Clean overview page with dev-only validation and stripped vision"
      contains: "process.env.NODE_ENV === 'development'"
  key_links:
    - from: "app/(dashboard)/projects/[id]/page.tsx"
      to: "lib/utils/vision.ts"
      via: "import stripVisionMetadata"
      pattern: "stripVisionMetadata\\("
---

<objective>
Apply 4 quick UX fixes across the product-helper app: change post-login redirect to /welcome-test for all users (UX-01), strip system prompt metadata from vision statement display (UX-02), hide PRD-SPEC Validation from non-dev environments (UX-08), and remove green hover highlighting from system overview actor rows (UX-09).

Purpose: These are low-risk, high-impact UX improvements that eliminate user-facing jargon, fix navigation, and clean up visual noise. They establish the baseline for the larger Wave 2 work.
Output: 4 targeted code changes + 1 new utility function.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-content-section-views-ux-polish/06-RESEARCH.md

Key file locations:
- Post-login redirect: `app/(login)/actions.ts` line 105
- New signup redirect: `app/(login)/actions.ts` line 237 (already goes to /welcome-test)
- Overview page: `app/(dashboard)/projects/[id]/page.tsx` (196 lines)
- Vision metadata injection: `components/onboarding/welcome-onboarding.tsx` lines 53-63
- Green hover: `components/projects/sections/system-overview-section.tsx` line 118
</context>

<tasks>

<task type="auto">
  <name>Task 1: Post-login redirect + vision metadata stripping</name>
  <files>
    app/(login)/actions.ts
    lib/utils/vision.ts
    components/onboarding/welcome-onboarding.tsx
  </files>
  <action>
    **UX-01: Post-login redirect**
    In `app/(login)/actions.ts`, change line 105 from `redirect('/projects')` to `redirect('/welcome-test')`. This makes returning users land on the welcome page, matching new user behavior (line 237 already redirects to `/welcome-test`).

    **UX-02: Vision metadata stripping**
    1. Create `lib/utils/vision.ts` with a `stripVisionMetadata()` function:
       - Removes `[Mode: Defined Scope]` or `[Mode: Guided Discovery]` prefix line
       - Removes `---` separator and all system context text after it
       - Handles null/undefined input gracefully (return empty string)
       - Trims whitespace
       - Pattern: `vision.replace(/^\[Mode:[^\]]*\]\s*\n*/m, '').replace(/\n---\n[\s\S]*$/, '').trim()`

    2. In `components/onboarding/welcome-onboarding.tsx`, do NOT change the storage format yet (existing projects depend on it). The stripping happens at display time only. Leave the `modePrefix` and `modeContext` logic as-is for now -- the display-side fix handles both legacy and future data.

    **Styling convention:** Use CSS variables (not Tailwind color classes) for any text colors per project conventions.
  </action>
  <verify>
    - `npx tsc --noEmit` compiles without new errors
    - Grep `actions.ts` for `redirect('/welcome-test')` on line 105 area
    - Grep `lib/utils/vision.ts` for `stripVisionMetadata` export
    - Run: `node -e "const {stripVisionMetadata} = require('./lib/utils/vision'); console.log(stripVisionMetadata('[Mode: Defined Scope]\n\nMy product description\n\n---\nUser has a defined scope.'))"` should output "My product description"
  </verify>
  <done>
    - Returning users redirected to /welcome-test after sign-in
    - `stripVisionMetadata()` correctly strips metadata from both legacy and clean vision strings
    - No TypeScript compilation errors introduced
  </done>
</task>

<task type="auto">
  <name>Task 2: Overview page cleanup (validation hide, vision strip, green hover removal)</name>
  <files>
    app/(dashboard)/projects/[id]/page.tsx
    components/projects/sections/system-overview-section.tsx
  </files>
  <action>
    **UX-08: Hide validation from non-dev**
    In `app/(dashboard)/projects/[id]/page.tsx`, wrap the `<ValidationReport>` component (lines 164-170) in a `process.env.NODE_ENV === 'development'` conditional. This is a server component so the check happens at render time and the component is tree-shaken in production builds.

    ```tsx
    {process.env.NODE_ENV === 'development' && (
      <ValidationReport
        projectId={project.id}
        projectName={project.name}
        initialValidationScore={project.validationScore || 0}
      />
    )}
    ```

    **UX-02 (display side): Strip vision metadata on overview page**
    Import `stripVisionMetadata` from `@/lib/utils/vision` and apply it to the vision display on line 156:
    ```tsx
    {stripVisionMetadata(project.vision)}
    ```
    instead of:
    ```tsx
    {project.vision}
    ```

    **UX-09: Remove green hover highlighting**
    In `components/projects/sections/system-overview-section.tsx`, remove the `'hover:bg-muted/50 transition-colors'` class from the actor table row `className` on line 118. Keep the `'border-b last:border-b-0'` class. The row should remain static on hover.

    Also check for similar hover patterns on data entity cards in the same file (~line 328). If `hover:bg-muted/50` appears there too, remove it as well. The voice notes specifically called out "green hover highlighting" as confusing.
  </action>
  <verify>
    - `npx tsc --noEmit` compiles without new errors
    - Grep `page.tsx` for `NODE_ENV` to confirm validation is gated
    - Grep `page.tsx` for `stripVisionMetadata` to confirm import and usage
    - Grep `system-overview-section.tsx` for `hover:bg-muted` should return NO results
    - `pnpm build` succeeds (confirms server component compatibility)
  </verify>
  <done>
    - ValidationReport only renders in development
    - Vision statement displays clean text (no [Mode:...] prefix, no system context)
    - No green hover highlight on system overview actor rows or entity cards
    - Build succeeds
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` -- no new TypeScript errors
2. `pnpm build` -- production build succeeds
3. Manual check: sign in and confirm redirect goes to /welcome-test page
4. Manual check: existing project overview shows clean vision text
5. Manual check: ValidationReport not visible on overview (unless NODE_ENV=development)
6. Manual check: system overview actors table rows don't highlight on hover
</verification>

<success_criteria>
- All 4 UX fixes applied (UX-01, UX-02, UX-08, UX-09)
- TypeScript compiles, build passes
- `stripVisionMetadata()` utility created and used on overview page
- Zero visual regressions in overview page layout
</success_criteria>

<output>
After completion, create `.planning/phases/06-content-section-views-ux-polish/06-01-SUMMARY.md`
</output>
