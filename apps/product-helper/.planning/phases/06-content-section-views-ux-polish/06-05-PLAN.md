---
phase: 06-content-section-views-ux-polish
plan: 05
type: execute
wave: 2
depends_on: ["06-01"]
files_modified:
  - lib/langchain/graphs/nodes/generate-response.ts
  - lib/education/knowledge-bank.ts
  - components/project/generation-progress-card.tsx
autonomous: true
subsystem: langchain

must_haves:
  truths:
    - "AI chat responses explain systems engineering terms in plain language before using technical names"
    - "Loading states during AI processing show rotating educational snippets about what Product Helper does"
    - "Educational snippets are accessible to all skill levels (not just systems engineers)"
    - "Existing step-specific knowledge bank content still works for LLM prompt injection"
  artifacts:
    - path: "lib/langchain/graphs/nodes/generate-response.ts"
      provides: "System prompt with plain language guidelines and glossary"
      contains: "Plain Language"
    - path: "lib/education/knowledge-bank.ts"
      provides: "General-purpose educational snippets alongside existing step-specific content"
      exports: ["generalThinkingMessages"]
    - path: "components/project/generation-progress-card.tsx"
      provides: "Loading card with ThinkingState integration"
      contains: "ThinkingState"
  key_links:
    - from: "components/project/generation-progress-card.tsx"
      to: "components/education/thinking-state.tsx"
      via: "React component import"
      pattern: "ThinkingState"
    - from: "components/project/generation-progress-card.tsx"
      to: "lib/education/knowledge-bank.ts"
      via: "import generalThinkingMessages"
      pattern: "generalThinkingMessages"
---

<objective>
Update AI chat responses to use plain language for systems engineering concepts (UX-06) and integrate rotating educational snippets into loading states (UX-07). The system prompt gets a plain language glossary and guidelines. The knowledge bank gets general-purpose educational messages that cycle during AI processing.

Purpose: Users with no systems engineering background should understand what the AI is talking about. Loading states should educate rather than just show a spinner. Both changes make the product more accessible and communicate value during wait times.
Output: Updated system prompt, new educational content, ThinkingState integration in loading card.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-content-section-views-ux-polish/06-RESEARCH.md

Key existing code:
- System prompt: `lib/langchain/graphs/nodes/generate-response.ts` lines 152-193 (Response Guidelines section)
- Knowledge bank: `lib/education/knowledge-bank.ts` (743 lines) -- 6 step-specific KB entries with ThinkingMessage[], tooltipTerms, and validation patterns
- ThinkingState component: `components/education/thinking-state.tsx` (~80 lines) -- cycles through ThinkingMessage[] with headline + tip + animation
- Generation progress card: `components/project/generation-progress-card.tsx` -- shows stage labels, progress bar, time estimate
- ThinkingMessage type: `{ headline: string; tip: string; duration: number }`

IMPORTANT: Do NOT rewrite existing step-specific knowledge bank content. ADD new general-purpose messages alongside it. The `buildPromptEducationBlock()` and `getTooltipTermsForStep()` functions must continue to work unchanged.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add plain language guidelines to system prompt</name>
  <files>
    lib/langchain/graphs/nodes/generate-response.ts
  </files>
  <action>
    In `generate-response.ts`, find the "Response Guidelines:" section in the system prompt (around lines 152-193). Add a new section BEFORE the existing guidelines, or as the first items in the guidelines list:

    Add a "Plain Language Communication" section to the prompt:

    ```
    ## Communication Style
    - Never assume the user knows systems engineering terminology
    - When first introducing a technical concept, explain it in everyday language FIRST, then give the technical term in parentheses
    - Pattern: "the people and systems that interact with your product (we call these 'actors')"
    - After introducing a term once in a conversation, you may use the technical term alone in later messages
    - Keep explanations conversational, not academic
    - Avoid acronyms unless you spell them out first

    ## Quick Glossary (use these plain-language versions when first introducing)
    - actors = "the people, teams, or external systems that interact with your product"
    - use cases = "the specific tasks or goals each user needs to accomplish"
    - system boundaries = "what your product handles vs. what it relies on external services for"
    - non-functional requirements = "quality standards like speed, security, and reliability"
    - data entities = "the main types of information your system stores and manages"
    - context diagram = "a bird's-eye view of your product and everything that connects to it"
    - scope tree = "a breakdown of your product's features organized by priority"
    - functional requirements = "the specific things your system must do, written as clear rules"
    ```

    Keep existing Response Guidelines intact. The new section should come right after the education block injection (around line 140) and before "Response Guidelines:".

    Do NOT modify `buildPromptEducationBlock()`, `buildResponsePrompt()`, or any other functions. Only change the prompt string template content.
  </action>
  <verify>
    - `npx tsc --noEmit` compiles without errors
    - Grep `generate-response.ts` for "Plain Language" or "Communication Style"
    - Grep for "Quick Glossary"
    - Existing "Response Guidelines:" section still present
    - No changes to function signatures or exports
  </verify>
  <done>
    - System prompt includes plain language communication guidelines
    - Glossary maps 8 technical terms to everyday language
    - Existing prompt structure preserved
    - No functional changes to generate-response node
  </done>
</task>

<task type="auto">
  <name>Task 2: Add general educational snippets and integrate ThinkingState into loading card</name>
  <files>
    lib/education/knowledge-bank.ts
    components/project/generation-progress-card.tsx
  </files>
  <action>
    **Part A: Add general-purpose educational snippets to knowledge-bank.ts**

    At the END of `knowledge-bank.ts` (after all existing exports), add a new exported array:

    ```typescript
    /**
     * General-purpose educational snippets shown during AI processing.
     * NOT tied to a specific KB step -- suitable for any loading state.
     * Written for ALL skill levels (beginners through experienced developers).
     */
    export const generalThinkingMessages: ThinkingMessage[] = [
      {
        headline: 'Building your product requirements...',
        tip: 'Product Helper follows the same methodology that systems engineers use to spec multi-million dollar projects -- adapted for modern software.',
        duration: 5000,
      },
      {
        headline: 'Identifying who uses your product...',
        tip: 'Mapping every person, team, and external system that touches your product early prevents costly "we forgot about X" discoveries later.',
        duration: 5000,
      },
      {
        headline: 'Defining what your product does...',
        tip: 'Each feature gets broken into specific user tasks. These become the building blocks of your development plan.',
        duration: 5000,
      },
      {
        headline: 'Drawing the line around your product...',
        tip: 'Knowing what you build vs. what you integrate with prevents scope creep and keeps your MVP focused.',
        duration: 5000,
      },
      {
        headline: 'Preparing technical specifications...',
        tip: 'Your PRD artifacts -- architecture, tech stack, API spec -- are designed to plug directly into AI coding tools like Cursor and Claude Code.',
        duration: 5000,
      },
      {
        headline: 'Analyzing your requirements...',
        tip: 'Good requirements answer "what" and "why" -- not "how." The technical decisions come from the requirements, not the other way around.',
        duration: 5000,
      },
      {
        headline: 'Structuring your project...',
        tip: 'A clear PRD saves 3-5x the time it takes to create. Teams with requirements docs ship faster and with fewer rewrites.',
        duration: 6000,
      },
      {
        headline: 'Mapping your product ecosystem...',
        tip: 'External services, payment providers, auth systems -- understanding your integrations shapes architecture decisions.',
        duration: 5000,
      },
      {
        headline: 'Generating your artifacts...',
        tip: 'Each section of your PRD is created by a specialized AI agent that focuses on one area of expertise.',
        duration: 5000,
      },
      {
        headline: 'Organizing your features...',
        tip: 'Not everything needs to ship in v1. Product Helper helps you identify must-haves vs. nice-to-haves using proven prioritization methods.',
        duration: 5000,
      },
    ];
    ```

    Ensure the `ThinkingMessage` type is imported or defined in the same file (it should already exist).

    **Part B: Integrate ThinkingState into GenerationProgressCard**

    Read `components/project/generation-progress-card.tsx` to understand its current structure. Then:

    1. Import `ThinkingState` from `@/components/education/thinking-state` and `generalThinkingMessages` from `@/lib/education/knowledge-bank`
    2. Replace the static stage label text (e.g., "Analyzing your message", "Processing requirements", etc.) with the `ThinkingState` component:

    Where the current card shows a text label for the current stage, replace it with:
    ```tsx
    <ThinkingState messages={generalThinkingMessages} />
    ```

    Keep the existing progress bar and time estimate below the ThinkingState. The ThinkingState should replace ONLY the stage label text, not the entire card layout.

    If the current stage labels are used for progress logic (mapping stage -> percentage), keep the logic but change what the user SEES. The ThinkingState cycles through educational messages regardless of the actual processing stage.

    **Fallback:** If `ThinkingState` component's API doesn't fit cleanly (e.g., it renders its own container), create a lightweight inline version that cycles through `generalThinkingMessages` using `useState` + `useEffect` with a rotating index. Use the same pattern: show `headline` in bold, `tip` as muted text, cycle every `duration` ms.
  </action>
  <verify>
    - `npx tsc --noEmit` compiles without errors
    - `pnpm build` succeeds
    - Grep `knowledge-bank.ts` for `generalThinkingMessages` export
    - Grep `generation-progress-card.tsx` for `ThinkingState` or `generalThinkingMessages`
    - Count: `generalThinkingMessages` array has 10 items
    - Existing KB exports (`knowledgeBankSteps`, `buildPromptEducationBlock`, `getTooltipTermsForStep`) still present and unchanged
  </verify>
  <done>
    - 10 general-purpose educational snippets added to knowledge-bank.ts
    - Snippets cover various aspects of PRD creation in plain language
    - GenerationProgressCard shows rotating ThinkingState messages during AI processing
    - Existing step-specific KB content untouched
    - All existing KB function exports still work
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` -- no TypeScript errors
2. `pnpm build` -- production build succeeds
3. System prompt contains plain language guidelines and glossary
4. `generalThinkingMessages` exported with 10 items
5. GenerationProgressCard uses ThinkingState or cycles through educational messages
6. Existing knowledge bank functions unchanged
</verification>

<success_criteria>
- UX-06: AI chat responses use "everyday explanation (technical term)" pattern for first introduction of concepts
- UX-07: Loading states show rotating educational snippets about PRD creation process
- Educational content works for beginners AND experienced developers
- No regressions to existing chat behavior or knowledge bank integration
- No changes to existing KB functions (buildPromptEducationBlock, getTooltipTermsForStep)
</success_criteria>

<output>
After completion, create `.planning/phases/06-content-section-views-ux-polish/06-05-SUMMARY.md`
</output>
