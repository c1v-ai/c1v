@startuml
title c1v product-helper â€” Activity Diagram (Generate Baseline PRD Package)

start

partition "PM" {
  :Start New PRD Project;
  :Enter Intake Inputs (mission, problem, success, stakeholders, constraints, assumptions);
  :Attach/Link Source Docs;
}

partition "System (Product-Helper)" {
  :Create Project Workspace;
  :Assign Unique Project ID/Version;
  :Store Intake Fields (structured);
  :Preserve Edit History;
  :Store Source References;
  :Link Sources to Intake Fields (traceability);
}

while (Intake sufficient to draft required artifacts?) is (No)
  partition "System (Product-Helper)" {
    :Evaluate Sufficiency vs SUFFICIENCY_TARGET_ARTIFACTS;
    :Identify Missing/Ambiguous Inputs;
  }
  partition "LLM" {
    :Generate Targeted Follow-up Questions;
  }
  partition "PM" {
    :Answer Follow-up Questions;
  }
  partition "System (Product-Helper)" {
    :Store Intake Extensions;
    :Tag Extensions to Unblocked Artifact(s);
  }
endwhile (Yes)

partition "System (Product-Helper)" {
  :Run Intake QC (INTAKE_QC_RULESET_ID);
}

partition "PM" {
  :Baseline Intake;
}

partition "System (Product-Helper)" {
  :Lock Intake Baseline (versioned snapshot);
  :Publish Baseline Intake Input Package;
}

partition "PM" {
  :Request Context Diagram Generation;
}
partition "LLM" {
  :Propose Context Model (entities + interactions + assumptions);
}
partition "System (Product-Helper)" {
  :Render Context Diagram;
  :Run Context Diagram QC (CONTEXT_DIAGRAM_QC_RULESET_ID);
  :Capture Change Requests (if any);
  :Regenerate/Adjust Context Model (if needed);
  :Baseline Context Diagram;
}

partition "PM" {
  :Request Use Case Model Generation;
}
partition "System (Product-Helper)" {
  :Auto-select latest baselined Intake + Context Diagram;
}
partition "LLM" {
  :Propose Use Case Model (actors + use cases + include/extend);
}
partition "System (Product-Helper)" {
  :Render Use Case Diagram;
  :Run UCD QC (UCD_QC_RULESET_ID);
  :Capture Change Requests (if any);
  :Regenerate Use Case Model (if needed);
  :Baseline Use Case Model;
}

partition "PM" {
  :Select Target Use Case(s);
  :Request UCBD Generation;
}
partition "LLM" {
  :Generate UCBD primary flow(s);
}
partition "System (Product-Helper)" {
  :Normalize UCBD wording;
  :Run UCBD QC (UCBD_QC_RULESET_ID);
  :Capture Change Requests (if any);
  :Regenerate UCBD(s) (if needed);
  :Baseline UCBD(s);
}

partition "PM" {
  :Generate PRD Artifact Package;
}
partition "System (Product-Helper)" {
  :Generate Requirements Table;
  :Generate Constants Definition Table;
  :Generate SysML Activity Diagram;
  :Package + Baseline PRD Artifact Bundle;
}

stop
@enduml
